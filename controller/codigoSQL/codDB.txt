CREATE DATABASE SMILIPS;

USE SMILIPS;

CREATE TABLE administrador(administradorID INT AUTO_INCREMENT PRIMARY KEY, email VARCHAR(100) NOT NULL, senha VARCHAR(35) NOT NULL);

CREATE TABLE usuario(usuarioID INT AUTO_INCREMENT PRIMARY KEY, nomeUsuario VARCHAR(100) NOT NULL, emailUsuario VARCHAR(100) UNIQUE NOT NULL, senhaUsuario VARCHAR(35) NOT NULL, telefone VARCHAR(20) NOT NULL, ftPerfil LONGBLOB NOT NULL, situacao VARCHAR(10) NOT NULL);

CREATE TABLE enderecoUsuario(enderecoUsuarioID INT AUTO_INCREMENT PRIMARY KEY, rua VARCHAR(45) NOT NULL, bairro VARCHAR(45) NOT NULL, numero VARCHAR(5) NOT NULL, complemento VARCHAR(45), usuarioID INT,  CONSTRAINT fK_enderecoUsuario_usuario FOREIGN KEY (usuarioID) REFERENCES usuario(usuarioID) ON UPDATE CASCADE ON DELETE CASCADE);

CREATE TABLE imovel(imovelID INT AUTO_INCREMENT PRIMARY KEY, tipo VARCHAR(20) NOT NULL, valorAluguel DOUBLE NOT NULL, qtdQuarto INT NOT NULL, qtdBanheiro INT NOT NULL, qtdGaragem INT NOT NULL, area VARCHAR(10) NOT NULL, descricao VARCHAR(200) NOT NULL, situacao VARCHAR(15) NOT NULL, usuarioID INT NOT NULL, CONSTRAINT fK_imovel_usuario FOREIGN KEY (usuarioID) REFERENCES usuario(usuarioID) ON UPDATE CASCADE ON DELETE CASCADE);

CREATE TABLE enderecoImovel(enderecoImovelID INT AUTO_INCREMENT PRIMARY KEY, rua VARCHAR(45) NOT NULL, cidade VARCHAR(3) NOT NULL, bairro VARCHAR(45) NOT NULL, numero VARCHAR(5) NOT NULL, complemento VARCHAR(45), imovelID INT,  CONSTRAINT fK_enderecoImovel_imovel FOREIGN KEY (imovelID) REFERENCES imovel(imovelID) ON UPDATE CASCADE ON DELETE CASCADE);

CREATE TABLE imgImovel(imgImovelID INT AUTO_INCREMENT PRIMARY KEY, imagem LONGBLOB NOT NULL, imovelID INT NOT NULL, CONSTRAINT fK_imgImovel_imovel FOREIGN KEY (imovelID) REFERENCES imovel(imovelID) ON UPDATE CASCADE ON DELETE CASCADE);

CREATE TABLE tipoServico(tipoServicoID INT AUTO_INCREMENT PRIMARY KEY, tipoServico VARCHAR(45) UNIQUE NOT NULL NOT NULL);

CREATE TABLE plano(planoID INT AUTO_INCREMENT PRIMARY KEY, nome VARCHAR(20) NOT NULL, descricao VARCHAR(250) NOT NULL, valor DOUBLE NOT NULL, duracao INT NOT NULL, qtdAnuncio INT NOT NULL);

CREATE TABLE servico(servicoID INT AUTO_INCREMENT PRIMARY KEY, descricao VARCHAR(250) NOT NULL, situacao VARCHAR(10) NOT NULL, tipoServicoID INT NOT NULL, usuarioID INT NOT NULL, CONSTRAINT fK_servico_tipoServico FOREIGN KEY (tipoServicoID) REFERENCES tipoServico(tipoServicoID) ON UPDATE CASCADE ON DELETE CASCADE, CONSTRAINT fK_servico_usuario FOREIGN KEY (usuarioID) REFERENCES usuario(usuarioID) ON UPDATE CASCADE ON DELETE CASCADE);

CREATE TABLE propaganda(propagandaID INT AUTO_INCREMENT PRIMARY KEY, propaganda LONGBLOB NOT NULL, situacao VARCHAR(10) NOT NULL, usuarioID INT NOT NULL, CONSTRAINT fK_propaganda_usuario FOREIGN KEY (usuarioID) REFERENCES usuario(usuarioID) ON UPDATE CASCADE ON DELETE CASCADE);

CREATE TABLE planoUsuario(planoUsuarioID INT AUTO_INCREMENT PRIMARY KEY, usuarioID INT NOT NULL, planoID INT NOT NULL, dataInicio VARCHAR(10) NOT NULL, dataFim VARCHAR(10) NOT NULL, situacao VARCHAR(10) NOT NULL, comprovante LONGBLOB NOT NULL, CONSTRAINT fK_usuarioPropaganda_usuario FOREIGN KEY (usuarioID) REFERENCES usuario(usuarioID) ON UPDATE CASCADE ON DELETE CASCADE, CONSTRAINT fK_usuarioPropaganda_plano FOREIGN KEY (planoID) REFERENCES plano(planoID) ON UPDATE CASCADE ON DELETE CASCADE);

CREATE TABLE notificacaoAnaliseImovel(notificacaoAnaliseImovelID INT AUTO_INCREMENT PRIMARY KEY, mensagem VARCHAR(250), situacao VARCHAR(10) NOT NULL, usuarioID INT NOT NULL, exibida BOOLEAN NOT NULL, CONSTRAINT fK_notificacaoAvaliacaoImovel_usuario FOREIGN KEY (usuarioID) REFERENCES usuario(usuarioID) ON UPDATE CASCADE ON DELETE CASCADE);

CREATE TABLE notificacaoAnalisePlano(notificacaoAnalisePlanoID INT AUTO_INCREMENT PRIMARY KEY, mensagem VARCHAR(250), situacao VARCHAR(10) NOT NULL, usuarioID INT NOT NULL, exibida BOOLEAN NOT NULL, CONSTRAINT fK_notificacaoAvaliacaoPlano_usuario FOREIGN KEY (usuarioID) REFERENCES usuario(usuarioID) ON UPDATE CASCADE ON DELETE CASCADE);

CREATE TABLE notificacaoAnalisePropaganda(notificacaoAnalisePropagandaID INT AUTO_INCREMENT PRIMARY KEY, mensagem VARCHAR(250), situacao VARCHAR(10) NOT NULL, usuarioID INT NOT NULL, exibida BOOLEAN NOT NULL, CONSTRAINT fK_notificacaoAvaliacaoPropaganda_usuario FOREIGN KEY (usuarioID) REFERENCES usuario(usuarioID) ON UPDATE CASCADE ON DELETE CASCADE);

CREATE TABLE denunciaImovel(denunciaImovelID INT AUTO_INCREMENT PRIMARY KEY, usuarioID INT NOT NULL, imovelID INT NOT NULL, motivo VARCHAR(250) NOT NULL, exibida BOOLEAN NOT NULL, CONSTRAINT fK_denunciaImovel_usuario FOREIGN KEY (usuarioID) REFERENCES usuario(usuarioID) ON UPDATE CASCADE ON DELETE CASCADE, CONSTRAINT fK_denunciaImovel_imovel FOREIGN KEY (imovelID) REFERENCES imovel(imovelID) ON UPDATE CASCADE ON DELETE CASCADE);

CREATE TABLE denunciaServico(denunciaServicoID INT AUTO_INCREMENT PRIMARY KEY, usuarioID INT NOT NULL, servicoID INT NOT NULL, motivo VARCHAR(250) NOT NULL, exibida BOOLEAN NOT NULL, CONSTRAINT fK_denunciaServico_usuario FOREIGN KEY (usuarioID) REFERENCES usuario(usuarioID) ON UPDATE CASCADE ON DELETE CASCADE, CONSTRAINT fK_denunciaServico_imovel FOREIGN KEY (servicoID) REFERENCES servico(servicoID) ON UPDATE CASCADE ON DELETE CASCADE);

DROP DATABASE SMILIPS;

DROP TABLE administrador;

DROP TABLE usuario;

DROP TABLE enderecoUsuario;

DROP TABLE imovel;

DROP TABLE enderecoImovel;

DROP TABLE imgImovel;

DROP TABLE tipoServico;

DROP TABLE plano;

DROP TABLE servico;

DROP TABLE propaganda;

DROP TABLE planoUsuario;

DROP TABLE notificacaoAnaliseImovel;

DROP TABLE notificacaoAnalisePlano;

DROP TABLE notificacaoAnalisePropaganda;

DROP TABLE denunciaImovel;

DROP TABLE denunciaServico;

